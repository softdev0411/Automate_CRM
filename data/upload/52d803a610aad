<?php

class cacheExampe
{
	private $espoMetadata;

	public function getOrmMetadata()
	{
		if (!empty($this->espoMetadata)) {
			return $this->espoMetadata;
		}

		$espoMetadataFile = Util::concatPath($this->getConfig()->get('cachePath'), 'ormMetadata.php');

		if (!file_exists($espoMetadataFile) || !$this->getConfig()->get('useCache')) {
	       	$this->getConverter()->process();
		}

		$this->espoMetadata = $this->getFileManager()->getContent($espoMetadataFile);

	    return $this->espoMetadata;
	}

	public function setOrmMetadata(array $espoMetadata)
	{
		 $result = $this->getFileManager()->setContentPHP($espoMetadata, $this->getConfig()->get('cachePath'), 'ormMetadata.php');
		 if ($result == false) {
		 	$GLOBALS['log']->add('EXCEPTION', 'Metadata::setOrmMetadata() - Cannot save ormMetadata to a file');
	        throw new \Espo\Core\Exceptions\Error();
		 }

		 $this->espoMetadata = $espoMetadata;

		 return $result;
	}

}

